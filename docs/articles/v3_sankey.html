<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Sankey Diagram • sfo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Create Sankey Diagram">
<meta property="og:description" content="sfo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sfo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1_intro.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/v2_analyzing_sfo.html">Analyzing SFO Passengers</a>
    </li>
    <li>
      <a href="../articles/v3_analyzing_landing.html">Analyzing SFO Landing</a>
    </li>
    <li>
      <a href="../articles/v3_sankey.html">Create Sankey Diagram</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="v3_sankey_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="v3_sankey_files/plotly-binding-4.10.1/plotly.js"></script><script src="v3_sankey_files/typedarray-0.1/typedarray.min.js"></script><script src="v3_sankey_files/jquery-3.5.1/jquery.min.js"></script><link href="v3_sankey_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="v3_sankey_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="v3_sankey_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="v3_sankey_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Create Sankey Diagram</h1>
            
      
      
      <div class="hidden name"><code>v3_sankey.Rmd</code></div>

    </div>

    
    
<p>A Sankey diagram is a common method for visualizing a numeric variable’s distribution across multiple categorical variables. The <code>sankey_ly</code> function is a wrapper for the <a href="https://plotly.com/r/sankey-diagram/" class="external-link">plotly Sankey</a> functionality, enables fast plotting with no need for any data transformation.</p>
<p>The function has the following arguments:</p>
<ul>
<li>
<code>x</code> - an aggregate data.frame object, must have at least two categorical variables and one numeric variable</li>
<li>
<code>cat_cols</code> - a vector of at least two categorical columns names</li>
<li>
<code>num_col</code> - a single numeric column name</li>
<li>
<code>title</code> - optiona, enables to set title for the plot</li>
</ul>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>Let’s see some use case of the function with the <code>sfo_passengers</code> dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sfo</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sfo_passengers"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sfo_passengers</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    45738 obs. of  12 variables:</span>
<span class="co">#&gt;  $ activity_period            : int  202012 202012 202012 202012 202012 202012 202012 202012 202012 202012 ...</span>
<span class="co">#&gt;  $ operating_airline          : chr  "Air Canada" "Air Canada" "Air France" "Air France" ...</span>
<span class="co">#&gt;  $ operating_airline_iata_code: chr  "AC" "AC" "AF" "AF" ...</span>
<span class="co">#&gt;  $ published_airline          : chr  "Air Canada" "Air Canada" "Air France" "Air France" ...</span>
<span class="co">#&gt;  $ published_airline_iata_code: chr  "AC" "AC" "AF" "AF" ...</span>
<span class="co">#&gt;  $ geo_summary                : chr  "International" "International" "International" "International" ...</span>
<span class="co">#&gt;  $ geo_region                 : chr  "Canada" "Canada" "Europe" "Europe" ...</span>
<span class="co">#&gt;  $ activity_type_code         : chr  "Deplaned" "Enplaned" "Deplaned" "Enplaned" ...</span>
<span class="co">#&gt;  $ price_category_code        : chr  "Other" "Other" "Other" "Other" ...</span>
<span class="co">#&gt;  $ terminal                   : chr  "International" "International" "International" "International" ...</span>
<span class="co">#&gt;  $ boarding_area              : chr  "G" "G" "A" "A" ...</span>
<span class="co">#&gt;  $ passenger_count            : int  2602 2099 759 1214 4544 4830 10830 11896 4157 4993 ...</span></code></pre></div>
<p>In the case of the <code>sfo_passengers</code> dataset, ignoring the date indicator, we have one numeric variable - <code>passenger_count</code> and 10 categorical variables. For the following examples we will focus on total number of passengers during 2020, last full year in the dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">sfo_passengers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity_period</span> <span class="op">&gt;=</span> <span class="fl">202001</span> <span class="op">&amp;</span> <span class="va">activity_period</span> <span class="op">&lt;</span> <span class="fl">202101</span><span class="op">)</span></code></pre></div>
<p>Now, we can start explore the distribution of the passengers by different categorical variables combination. Let’s start with a simplistic example, plotting the distribution of passengers by <code>geo_sumary</code> and <code>geo_region</code>. The <code>sunkey_ly</code> function required that the data will be aggregated by the categorical variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_summary</span>, <span class="va">geo_region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">passenger_count</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;   geo_summary   geo_region             total</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Domestic      US                  26<span style="text-decoration: underline;">236</span>690</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> International Asia                 2<span style="text-decoration: underline;">544</span>206</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> International Australia / Oceania   <span style="text-decoration: underline;">547</span>110</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> International Canada                <span style="text-decoration: underline;">669</span>002</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> International Central America       <span style="text-decoration: underline;">188</span>328</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> International Europe               1<span style="text-decoration: underline;">568</span>216</span></code></pre></div>
<p>Now, as the data is ready, we visualize the data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sankey_ly.html">sankey_ly</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d1</span>, 
          cat_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_summary"</span>, <span class="st">"geo_region"</span><span class="op">)</span>, 
          num_col <span class="op">=</span> <span class="st">"total"</span>, 
          title <span class="op">=</span> <span class="st">"Distribution of Passengers by Geo Type and Region"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-380c072f17883c1cfa63" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-380c072f17883c1cfa63">{"x":{"visdat":{"20af2978f6da":["function () ","plotlyVisDat"]},"cur_data":"20af2978f6da","attrs":{"20af2978f6da":{"orientation":"h","valueformat":".0f","node":{"label":["Domestic","International","US","Asia","Australia / Oceania","Canada","Central America","Europe","Mexico","Middle East"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,1,1,1,1,1,1,1],"target":[2,3,4,5,6,7,8,9],"value":[26236690,2544206,547110,669002,188328,1568216,842602,241272]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Passengers by Geo Type and Region","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"orientation":"h","valueformat":".0f","node":{"label":["Domestic","International","US","Asia","Australia / Oceania","Canada","Central America","Europe","Mexico","Middle East"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,1,1,1,1,1,1,1],"target":[2,3,4,5,6,7,8,9],"value":[26236690,2544206,547110,669002,188328,1568216,842602,241272]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>In a similar manner we can add additional variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">operating_airline</span> <span class="op">==</span> <span class="st">"United Airlines"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">operating_airline</span>,<span class="va">activity_type_code</span>, <span class="va">geo_summary</span>, <span class="va">geo_region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">passenger_count</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/sankey_ly.html">sankey_ly</a></span><span class="op">(</span>cat_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"operating_airline"</span>, <span class="st">"geo_summary"</span>, <span class="st">"geo_region"</span>, <span class="st">"activity_type_code"</span><span class="op">)</span>, 
            num_col <span class="op">=</span> <span class="st">"total"</span>,
            title <span class="op">=</span> <span class="st">"Distribution of United Airlines Passengers at SFO During 2020"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f83d213ff0194bb6e1d4" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f83d213ff0194bb6e1d4">{"x":{"visdat":{"20af727e4f6a":["function () ","plotlyVisDat"]},"cur_data":"20af727e4f6a","attrs":{"20af727e4f6a":{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,1,2,2,2,2,2,2,4,4,5,5,6,6,6,7,7,8,8,9,9,3,3,3],"target":[1,2,3,4,5,6,7,8,9,10,11,10,11,10,11,12,10,11,10,11,10,11,10,11,12],"value":[10020182,2340264,10020182,906632,315870,191150,413926,418534,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of United Airlines Passengers at SFO During 2020","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,1,2,2,2,2,2,2,4,4,5,5,6,6,6,7,7,8,8,9,9,3,3,3],"target":[1,2,3,4,5,6,7,8,9,10,11,10,11,10,11,12,10,11,10,11,10,11,10,11,12],"value":[10020182,2340264,10020182,906632,315870,191150,413926,418534,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="failure">Failure!<a class="anchor" aria-label="anchor" href="#failure"></a>
</h3>
<p>Here is some pitful you should be aware of, the function is sensitive for the categorical variables name. It will fail to map the different categories correctly if two variables share the same unique label. The following example, where both the <code>geo_summary</code> and <code>terminal</code> variables share the label <code>international</code>, demonstrates this issue:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">operating_airline</span> <span class="op">==</span> <span class="st">"United Airlines"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">operating_airline</span>,<span class="va">activity_type_code</span>, <span class="va">geo_summary</span>, <span class="va">geo_region</span>,  <span class="va">terminal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">passenger_count</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/sankey_ly.html">sankey_ly</a></span><span class="op">(</span>cat_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"operating_airline"</span>, <span class="st">"geo_summary"</span>, <span class="st">"geo_region"</span>, <span class="st">"activity_type_code"</span>, <span class="st">"terminal"</span><span class="op">)</span>, 
            num_col <span class="op">=</span> <span class="st">"total"</span>,
            title <span class="op">=</span> <span class="st">"Distribution of United Airlines Passengers at SFO During 2020"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-ca8b5853930fe2ed05cf" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca8b5853930fe2ed05cf">{"x":{"visdat":{"20af7892309c":["function () ","plotlyVisDat"]},"cur_data":"20af7892309c","attrs":{"20af7892309c":{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit","International","Terminal 3"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,1,2,13,2,13,2,13,2,13,2,13,2,13,4,4,5,5,6,6,6,7,7,8,8,9,9,3,3,3,10,10,10,11,11,11,12,12,12],"target":[1,2,13,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,10,11,10,11,12,10,11,10,11,10,11,10,11,12,2,13,14,2,13,14,2,13,14],"value":[10020182,2340264,2340264,10020182,906632,906632,315870,315870,191150,191150,413926,413926,418534,418534,94152,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876,1319840,1319840,4885830,1121986,1121986,5031908,6,6,876]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of United Airlines Passengers at SFO During 2020","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit","International","Terminal 3"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,0,1,2,13,2,13,2,13,2,13,2,13,2,13,4,4,5,5,6,6,6,7,7,8,8,9,9,3,3,3,10,10,10,11,11,11,12,12,12],"target":[1,2,13,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,10,11,10,11,12,10,11,10,11,10,11,10,11,12,2,13,14,2,13,14,2,13,14],"value":[10020182,2340264,2340264,10020182,906632,906632,315870,315870,191150,191150,413926,413926,418534,418534,94152,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876,1319840,1319840,4885830,1121986,1121986,5031908,6,6,876]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To overcome this issue, you will have to make sure that there is no overlapping between the variables label. Let’s modify the cases where <code>terminal</code> variable is set as <code>International</code> to <code>international</code> (<code>I</code> -&gt; <code>i</code>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">operating_airline</span> <span class="op">==</span> <span class="st">"United Airlines"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>terminal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">terminal</span> <span class="op">==</span> <span class="st">"International"</span>, <span class="st">"international"</span>, <span class="va">terminal</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">operating_airline</span>,<span class="va">activity_type_code</span>, <span class="va">geo_summary</span>, <span class="va">geo_region</span>,  <span class="va">terminal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">passenger_count</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/sankey_ly.html">sankey_ly</a></span><span class="op">(</span>cat_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"operating_airline"</span>, <span class="st">"terminal"</span>,<span class="st">"geo_summary"</span>, <span class="st">"geo_region"</span>, <span class="st">"activity_type_code"</span><span class="op">)</span>, 
            num_col <span class="op">=</span> <span class="st">"total"</span>,
            title <span class="op">=</span> <span class="st">"Distribution of United Airlines Passengers at SFO During 2020"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-feae7756d2612b850f73" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-feae7756d2612b850f73">{"x":{"visdat":{"20af12e72cde":["function () ","plotlyVisDat"]},"cur_data":"20af12e72cde","attrs":{"20af12e72cde":{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","international","Terminal 3","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,1,1,2,2,3,4,4,4,4,4,4,6,6,7,7,8,8,8,9,9,10,10,11,11,5,5,5],"target":[1,2,3,4,3,4,5,6,7,8,9,10,11,12,13,12,13,12,13,14,12,13,12,13,12,13,12,13,14],"value":[2441832,9918614,481596,1960236,9538586,380028,10020182,906632,315870,191150,413926,418534,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of United Airlines Passengers at SFO During 2020","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"orientation":"h","valueformat":".0f","node":{"label":["United Airlines","international","Terminal 3","Domestic","International","US","Asia","Australia / Oceania","Canada","Europe","Mexico","Middle East","Deplaned","Enplaned","Thru / Transit"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,0,1,1,2,2,3,4,4,4,4,4,4,6,6,7,7,8,8,8,9,9,10,10,11,11,5,5,5],"target":[1,2,3,4,3,4,5,6,7,8,9,10,11,12,13,12,13,12,13,14,12,13,12,13,12,13,12,13,14],"value":[2441832,9918614,481596,1960236,9538586,380028,10020182,906632,315870,191150,413926,418534,94152,472982,433650,169676,146194,91782,99362,6,212098,201828,209744,208790,50936,43216,4998452,5020854,876]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rami Krispin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
